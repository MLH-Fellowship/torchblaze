<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/torchblaze/blog/rss.xml" title="TorchBlaze Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/torchblaze/blog/atom.xml" title="TorchBlaze Blog Atom Feed"><title data-react-helmet="true">MLTests | TorchBlaze</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="MLTests | TorchBlaze"><meta data-react-helmet="true" name="description" content="TorchBlaze comes with a PyTorch-based model testing suite, which is essentially a set of methods that can be used to perform a variety of integrity checks on your PyTorch models before and during the model training process in a bit to ensure that no unexpected results show up in your model outputs."><meta data-react-helmet="true" property="og:description" content="TorchBlaze comes with a PyTorch-based model testing suite, which is essentially a set of methods that can be used to perform a variety of integrity checks on your PyTorch models before and during the model training process in a bit to ensure that no unexpected results show up in your model outputs."><meta data-react-helmet="true" property="og:url" content="https://github.com/MLH-Fellowship.github.io/torchblaze/docs/mltests"><link data-react-helmet="true" rel="shortcut icon" href="/torchblaze/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://github.com/MLH-Fellowship.github.io/torchblaze/docs/mltests"><link rel="stylesheet" href="/torchblaze/styles.5a08de51.css">
<link rel="preload" href="/torchblaze/styles.7e3a578a.js" as="script">
<link rel="preload" href="/torchblaze/runtime~main.69f9236f.js" as="script">
<link rel="preload" href="/torchblaze/main.8ee63653.js" as="script">
<link rel="preload" href="/torchblaze/common.7eb12ce9.js" as="script">
<link rel="preload" href="/torchblaze/2.fd0d8348.js" as="script">
<link rel="preload" href="/torchblaze/30.349ce7e4.js" as="script">
<link rel="preload" href="/torchblaze/31.b2162068.js" as="script">
<link rel="preload" href="/torchblaze/935f2afb.aede11c5.js" as="script">
<link rel="preload" href="/torchblaze/17896441.e150fc05.js" as="script">
<link rel="preload" href="/torchblaze/6546a84d.d17a20f4.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/torchblaze/"><img src="/torchblaze/img/logo.svg" alt="TorchBlaze Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/torchblaze/img/logo.svg" alt="TorchBlaze Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">TorchBlaze</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/torchblaze/docs/installation">Docs</a><a class="navbar__item navbar__link" href="/torchblaze/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/MLH-Fellowship/torchblaze" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/torchblaze/"><img src="/torchblaze/img/logo.svg" alt="TorchBlaze Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/torchblaze/img/logo.svg" alt="TorchBlaze Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">TorchBlaze</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/torchblaze/docs/installation">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/torchblaze/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/MLH-Fellowship/torchblaze" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/torchblaze/docs/installation">Installation</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Documentation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/torchblaze/docs/setup">Setup a TorchBlaze ML Project</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/torchblaze/docs/mltests">MLTests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/torchblaze/docs/apitest">APITests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/torchblaze/docs/docker">Dockerizing Your Projects</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">MLTests</h1></header><div class="markdown"><p>TorchBlaze comes with a PyTorch-based model testing suite, which is essentially a set of methods that can be used to perform a variety of integrity checks on your PyTorch models before and during the model training process in a bit to ensure that no unexpected results show up in your model outputs. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="getting-started-with-mltests"></a>Getting Started with MLTests<a class="hash-link" href="#getting-started-with-mltests" title="Direct link to heading">#</a></h2><hr><p>For using the set of automated model-testing methods available in the <strong>mltests</strong> module, the first step is to import it. This can be achieved with this simple command:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-py codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torchblaze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mltests </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> mls</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>To get a list of all the methods available in the module, you can use the following command:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-py codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token builtin" style="color:rgb(130, 170, 255)">dir</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">mls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Here&#x27;s the list of methods, along with their usage, provided in the <strong>mltests</strong> package.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="model-tests"></a>Model Tests<a class="hash-link" href="#model-tests" title="Direct link to heading">#</a></h2><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-mlsget_params"></a># mls.get_params<a class="hash-link" href="#-mlsget_params" title="Direct link to heading">#</a></h3><p>Retrieves the list of all the named parameters associated with a model.</p><p>Arguments:
model::torch.nn.Module- Ideally the deep learning model, but can be a singel model layer/set of layers too.</p><p>Returns:
param_list::list- List of all the named parameters in the model.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="usage"></a>Usage:<a class="hash-link" href="#usage" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-py codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torchblaze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mltests </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> mls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># assuming that your model class object is stored in variable &#x27;model&#x27; </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">param_list </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> mls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">param_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Each element in the param_list will be a tuple, the first element of which is the parameter name, and the second element is the tensor of parameters associated with the named parameter. </p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-mlscheck_cuda"></a># mls.check_cuda<a class="hash-link" href="#-mlscheck_cuda" title="Direct link to heading">#</a></h3><p>Checks if the training device is of type CUDA or not.</p><p>Arguments:
params::torch.Tensor- The parameters associated with a model layer.</p><p>Returns:
None: Throws an exception if the training device is not CUDA-enabled. </p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="usage-1"></a>Usage:<a class="hash-link" href="#usage-1" title="Direct link to heading">#</a></h4><p>Here is a an example of how you can implement this test. In order to use it as a standalone test, you need to provide the method, as an argument, a tensor of named parameters associated with the model. It can be any named parameter associated with the model.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-py codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torchblaze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mltests </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> mls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># getting the list of named parameters of the model </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">param_list </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> mls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># getting a single named parameter tensor from the list</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">param </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> param_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># performing the test</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">mls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">check_cude</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">param</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In case the model is not training on a CUDA-enabled device, you will get a <code>DeviceNotCudaException</code> exception. </p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-mlscheck_nan"></a># mls.check_nan<a class="hash-link" href="#-mlscheck_nan" title="Direct link to heading">#</a></h3><p>Tests for the presence of NaN values [torch.tensor(float(&quot;nan&quot;))] in the given tensor of model parameter.</p><p>Arguments:
name::str- Name of the parameter
params::torch.Tensor- Trainable named parameters associated with a layer</p><p>Returns:
None- Throws an exception in case any parameter is a NaN value. </p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="usage-2"></a>Usage:<a class="hash-link" href="#usage-2" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-py codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torchblaze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mltests </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> mls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># getting the list of named parameters of the model </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">param_list </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> mls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># performing nan-value check on every named parameter </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> param </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> param_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    check_nan</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> param</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In case any model parameter is a NaN value you will get a <code>NaNParamsException</code> exception. </p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-mlscheck_infinite"></a># mls.check_infinite<a class="hash-link" href="#-mlscheck_infinite" title="Direct link to heading">#</a></h3><p>Tests for the presence of infinite values [torch.tensor(float(&quot;Inf&quot;))] in the given tensor of model parameter.</p><p>Arguments:
name::str- Name of the parameter
params::torch.Tensor- Trainable named parameters associated with a layer</p><p>Returns:
None- Throws an exception in case any parameter is a Inf value. </p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="usage-3"></a>Usage:<a class="hash-link" href="#usage-3" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-py codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torchblaze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mltests </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> mls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># getting the list of named parameters of the model </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">param_list </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> mls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># performing infinite-value check on every named parameter </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> param </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> param_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    check_infinite</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> param</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In case any model parameter is a infinite value you will get a <code>InfParamsException</code> exception. </p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-mlscheck_smaller"></a># mls.check_smaller<a class="hash-link" href="#-mlscheck_smaller" title="Direct link to heading">#</a></h3><p>Tests if the absolute value of any parameter exceeds a certain threshold.</p><p>Arguments:
name::str- Name of the parameter
params::torch.Tensor- Trainable named parameters associated with a layer
upper_limit::float- The threshold value every parameter should be smaller than in terms of its absolute value.</p><p>Returns:
None- Throws an exception in case any parameter is a exceeds threshold value. </p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="usage-4"></a>Usage:<a class="hash-link" href="#usage-4" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-py codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torchblaze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mltests </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> mls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># getting the list of named parameters of the model </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">param_list </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> mls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># performing the check on every named parameter </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> param </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> param_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    check_smaller</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> param</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> upper_limit</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1e2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In case any parameter exceeds a upper_limit threshold value you will get a <code>ParamsTooLargeException</code> exception. </p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-mlscheck_greater"></a># mls.check_greater<a class="hash-link" href="#-mlscheck_greater" title="Direct link to heading">#</a></h3><p>Tests if the absolute value of any parameter falls below a certain threshold.</p><p>Arguments:
name::str- Name of the parameter
params::torch.Tensor- Trainable named parameters associated with a layer
lower_limit::float- The threshold value every parameter should be greater than in terms of its absolute value.</p><p>Returns:
None- Throws an exception in case any parameter is a NaN value. </p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="usage-5"></a>Usage:<a class="hash-link" href="#usage-5" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-py codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torchblaze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mltests </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> mls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># getting the list of named parameters of the model </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">param_list </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> mls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># performing the check on every named parameter </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> param </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> param_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    check_greater</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> param</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> lower_limit</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1e</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In case any parameter falls below the lower_limit threshold value you will get a <code>ParamsTooSmallException</code> exception. </p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-mlscheck_gradient_smaller"></a># mls.check_gradient_smaller<a class="hash-link" href="#-mlscheck_gradient_smaller" title="Direct link to heading">#</a></h3><p>Tests if the absolute gradient value for any parameter exceed a certain threshold. Can be used to check for gradient explosion.</p><p>Arguments:
name::str- Name of the parameter
params::torch.Tensor- Trainable named parameters associated with a layer
grad_limit::float- A threshold value, such that, |params.grad| &lt; grad_limit</p><p>Returns:
None- Throws an exception in case the gradient for any parameter exceeds the threshold value (grad_limit)
OR
None- Throws an exception in case the method is used without running the loss.backward() method for backprop. </p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="usage-6"></a>Usage:<a class="hash-link" href="#usage-6" title="Direct link to heading">#</a></h4><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Running this method for a model whose gradients have not been initialized (i.e., a model that has not gone training) will result in GradientsUninitializedException.</p></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-py codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torchblaze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mltests </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> mls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># getting the list of named parameters of the model </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">param_list </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> mls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># performing gradient check on every named parameter (assuming model has undergone at least one step of training) </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> param </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> param_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    check_gradient_smaller</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> grad_limit</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1e4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In case any parameter&#x27;s gradient value exceeds the grad_limit threshold value, you will get a <code>GradientAboveThresholdException</code> exception. </p><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-mlscheck_params_changing"></a># mls.check_params_changing<a class="hash-link" href="#-mlscheck_params_changing" title="Direct link to heading">#</a></h3><p>Tests if the parameters in the model/certain layer are changing after a training cycle.</p><p>Arguments:
name::str- Name of the parameter
params_list_old::list- List of trainable model parameters BEFORE training cycle.
params_list_new::list- List of trainable model parameters AFTER training cycle.</p><p>Returns:
None- Throws an exception in case the parameters are not changing </p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="usage-7"></a>Usage:<a class="hash-link" href="#usage-7" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-py codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torchblaze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mltests </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> mls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># getting the list of named parameters of the model BEFORE training</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">param_list_old </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> mls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># getting the list of named parameters of the model AFTER training</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">param_list_new </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> mls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_params</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># performing the parameter-change test </span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">check_params_changing</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">params_list_old</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> params_list_new</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In case none of the model parameters change after training the model, you get a <code>ParamsNotChangingException</code> exception. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="automated-test"></a>Automated Test<a class="hash-link" href="#automated-test" title="Direct link to heading">#</a></h2><hr><p>While the methods given above can be used to define your own model tests, the mltests module comes with an automated test too.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-mlsmodel_test"></a># mls.model_test<a class="hash-link" href="#-mlsmodel_test" title="Direct link to heading">#</a></h3><p>Executes a suite of automated tests on the ML model.
Set &lt;test_name&gt; = False if you want to exclude a certain test from the test suite.</p><p>Arguments:
model::nn.Module- The model that you want to test.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">batch_x::torch.Tensor- A single batch of data features to perform model checks</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">batch_y::torch.Tensor- A single batch of data labels to perform model checks</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">optim_fn::torch.optim- default=torch.optim.Adam, Optimizer algorithm to be used during model training </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">loss_fn- default=torch.nn.CrossEntropyLoss, Loss function to be used for model evaluation during training</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">test_gradient_smaller::bool- default=True, Asserts if gradients exceed a certain threshold  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">test_greater::bool- default=True, Asserts if all parameters &gt; threshold limit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">test_smaller::bool- default=True, Asserts if all parameters &lt; threshold limit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">test_infinite::bool- default=True, Asserts that no parameters == infinite</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">test_nan::bool- default=True, Asserts that no parameters == NaN</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">test_params_changing::bool- Default=False, Asserts that all the parameters change/update after the training is complete</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">test_cuda::bool- Default=False, Asserts that the model is training on a cuda-enabled GPU</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">upper_limit::float- default=1e2, Absolute value of all parameters should be smaller than this threshold value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">lower_limit::float- default=1e-2, Absolute value of all parameters should be greater than this threshold value</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">grad_limit::float- default=1e4, Absolute value of all gradients should be smaller than this threshold value </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="usage-8"></a>Usage:<a class="hash-link" href="#usage-8" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-py codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> torchblaze</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mltests </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> mls</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># loss function</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">criterion </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">CrossEntropyLoss</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># optimizer function</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">optimizer </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">optim</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">SGD</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">net</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">parameters</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> lr</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> momentum</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.9</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># running automated tests</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">model_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">model</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">net</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> batch_x</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> batch_y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> optim_fn</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">optimizer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> loss_fn</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">criterion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In the example given above, we assume that the model class object is stored under that variable name <code>net</code>.
x: A batch of training features
y: A batch of training lables, corresponding to the feature batch x. </p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/torchblaze/docs/setup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Setup a TorchBlaze ML Project</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/torchblaze/docs/apitest"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">APITests Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-started-with-mltests" class="table-of-contents__link">Getting Started with MLTests</a></li><li><a href="#model-tests" class="table-of-contents__link">Model Tests</a><ul><li><a href="#-mlsget_params" class="table-of-contents__link"># mls.get_params</a></li><li><a href="#-mlscheck_cuda" class="table-of-contents__link"># mls.check_cuda</a></li><li><a href="#-mlscheck_nan" class="table-of-contents__link"># mls.check_nan</a></li><li><a href="#-mlscheck_infinite" class="table-of-contents__link"># mls.check_infinite</a></li><li><a href="#-mlscheck_smaller" class="table-of-contents__link"># mls.check_smaller</a></li><li><a href="#-mlscheck_greater" class="table-of-contents__link"># mls.check_greater</a></li><li><a href="#-mlscheck_gradient_smaller" class="table-of-contents__link"># mls.check_gradient_smaller</a></li><li><a href="#-mlscheck_params_changing" class="table-of-contents__link"># mls.check_params_changing</a></li></ul></li><li><a href="#automated-test" class="table-of-contents__link">Automated Test</a><ul><li><a href="#-mlsmodel_test" class="table-of-contents__link"># mls.model_test</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/torchblaze/docs/installation/">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/torchblaze/docs/setup/">Quick Setup</a></li><li class="footer__item"><a class="footer__link-item" href="/torchblaze/docs/mltests/">Model Testing</a></li><li class="footer__item"><a class="footer__link-item" href="/torchblaze/docs/apitest/">API Testing</a></li><li class="footer__item"><a class="footer__link-item" href="/torchblaze/docs/docker/">Quick Dockerizing</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/torchblaze/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/MLH-Fellowship/torchblaze" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 TorchBlaze, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/torchblaze/styles.7e3a578a.js"></script>
<script src="/torchblaze/runtime~main.69f9236f.js"></script>
<script src="/torchblaze/main.8ee63653.js"></script>
<script src="/torchblaze/common.7eb12ce9.js"></script>
<script src="/torchblaze/2.fd0d8348.js"></script>
<script src="/torchblaze/30.349ce7e4.js"></script>
<script src="/torchblaze/31.b2162068.js"></script>
<script src="/torchblaze/935f2afb.aede11c5.js"></script>
<script src="/torchblaze/17896441.e150fc05.js"></script>
<script src="/torchblaze/6546a84d.d17a20f4.js"></script>
</body>
</html>