<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/torchblaze/blog/rss.xml" title="TorchBlaze Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/torchblaze/blog/atom.xml" title="TorchBlaze Blog Atom Feed"><title data-react-helmet="true">Setup a TorchBlaze ML Project | TorchBlaze</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Setup a TorchBlaze ML Project | TorchBlaze"><meta data-react-helmet="true" name="description" content="TorchBlaze allows you to setup your ML project within no time! With our template, you will be ready to jump in to making your model and training it without worrying about the hassles of testing and deployment, and leaving that upto us. The template is just to display a basic example to get you started on your journey with TorchBlaze and build some great things!"><meta data-react-helmet="true" property="og:description" content="TorchBlaze allows you to setup your ML project within no time! With our template, you will be ready to jump in to making your model and training it without worrying about the hassles of testing and deployment, and leaving that upto us. The template is just to display a basic example to get you started on your journey with TorchBlaze and build some great things!"><meta data-react-helmet="true" property="og:url" content="https://github.com/MLH-Fellowship.github.io/torchblaze/docs/setup"><link data-react-helmet="true" rel="shortcut icon" href="/torchblaze/img/blaze.svg"><link data-react-helmet="true" rel="canonical" href="https://github.com/MLH-Fellowship.github.io/torchblaze/docs/setup"><link rel="stylesheet" href="/torchblaze/styles.5a08de51.css">
<link rel="preload" href="/torchblaze/styles.59e02f7c.js" as="script">
<link rel="preload" href="/torchblaze/runtime~main.1033aead.js" as="script">
<link rel="preload" href="/torchblaze/main.b0f00e50.js" as="script">
<link rel="preload" href="/torchblaze/common.97de925f.js" as="script">
<link rel="preload" href="/torchblaze/2.8c9f76bf.js" as="script">
<link rel="preload" href="/torchblaze/28.94914dfa.js" as="script">
<link rel="preload" href="/torchblaze/29.a3a5c550.js" as="script">
<link rel="preload" href="/torchblaze/935f2afb.aede11c5.js" as="script">
<link rel="preload" href="/torchblaze/17896441.c19fbad7.js" as="script">
<link rel="preload" href="/torchblaze/3847b3ea.94b8f644.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/torchblaze/"><img src="/torchblaze/img/torchblaze.svg" alt="TorchBlaze Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/torchblaze/img/torchblaze.svg" alt="TorchBlaze Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">TorchBlaze</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/torchblaze/docs/installation">Docs</a><a class="navbar__item navbar__link" href="/torchblaze/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/MLH-Fellowship/torchblaze" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/torchblaze/"><img src="/torchblaze/img/torchblaze.svg" alt="TorchBlaze Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/torchblaze/img/torchblaze.svg" alt="TorchBlaze Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">TorchBlaze</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/torchblaze/docs/installation">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/torchblaze/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/MLH-Fellowship/torchblaze" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/torchblaze/docs/installation">Installation</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Documentation</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/torchblaze/docs/setup">Setup a TorchBlaze ML Project</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/torchblaze/docs/mltests">MLTests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/torchblaze/docs/apitest">APITests</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/torchblaze/docs/docker">Dockerizing Your Projects</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Setup a TorchBlaze ML Project</h1></header><div class="markdown"><p>TorchBlaze allows you to setup your ML project within no time! With our template, you will be ready to jump in to making your model and training it without worrying about the hassles of testing and deployment, and leaving that upto us. The template is just to display a basic example to get you started on your journey with TorchBlaze and build some great things!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="getting-started-with-the-template"></a>Getting Started with the template<a class="hash-link" href="#getting-started-with-the-template" title="Direct link to heading">#</a></h2><hr><p>Generate the template for your project using the following command:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">foo@bar:~$ torchblaze generate_template </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">your_project_name</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This will create a directory titled <code>&lt;your_project_name&gt;</code> and contain the template files.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Before proceeding, make sure you have torch installed on your system/virtual environment. In case you do not have it installed, you can install your relevant PyTorch version from <a href="https://pytorch.org/get-started/locally/" target="_blank" rel="noopener noreferrer">here</a>.  </p></div></div><p>Install the required python packages for running the template example using the following command:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">foo@bar:~$ pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> -r requirements.txt</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You are now set to modify the template to your liking and continue with the deployment!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="running-the-template"></a>Running the template<a class="hash-link" href="#running-the-template" title="Direct link to heading">#</a></h2><p>To begin training the existing model definition present in <code>model/model.py</code> and save the final model, you can execute:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">foo@bar:~$ python model/train.py --save-model</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You can supply any of the command-line arguments defined in <code>model/train.py</code> to enhance the model training in several ways. Once your model is trained and saved, you can either execute your ready-to-deploy flask-api on your local machine like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">foo@bar:~$ python app.py</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>or you could generate a docker image to wrap your flask-api and model with the command:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-shell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">foo@bar:~$ torchblaze generate_docker </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">your_docker_image_name</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Once you are convinced your API is ready for deployment, you can use the <code>Procfile</code> that has been generated to deploy your API as a Heroku App.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="contents-of-the-template"></a>Contents of the Template<a class="hash-link" href="#contents-of-the-template" title="Direct link to heading">#</a></h2><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-modelmodelpy"></a># model/model.py<a class="hash-link" href="#-modelmodelpy" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="file-purpose"></a>File Purpose<a class="hash-link" href="#file-purpose" title="Direct link to heading">#</a></h4><p>This file should contain the:</p><ol><li>model layers definition</li><li>model architecture definition</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="file-contents"></a>File Contents:<a class="hash-link" href="#file-contents" title="Direct link to heading">#</a></h4><ol><li>Model definition defined in <code>__init__(self)</code> which takes as input a batch of 28x28 grayscale images and outputs a batch of softmax-probability vectors, each of length 10.</li><li>CNN based model for classifying handwritten numbers with the model architecture defined in <code>forward()</code>. </li></ol><hr><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-modeltrainpy"></a># model/train.py<a class="hash-link" href="#-modeltrainpy" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="file-purpose-1"></a>File Purpose<a class="hash-link" href="#file-purpose-1" title="Direct link to heading">#</a></h4><p>This file should contain the functionality for:</p><ol><li>setting hyperparameters through methods such as command-line arguments or config files.</li><li>Loading and Pre-processing data for model input</li><li>Creating model, optimizer and criterion. (optional: scheduler)</li><li>Training Loop to iterate once over the complete training dataset and train the model.</li><li>Testing Loop to perform inference once over the complete testing dataset.</li><li>Epoch Loop to call the training loop a certain number of times as defined in hyperparameters</li><li>Evaluate model on test set to infer the model accuracy</li><li>Ability to save the model to disk.</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="file-contents-1"></a>File Contents:<a class="hash-link" href="#file-contents-1" title="Direct link to heading">#</a></h4><ol><li>Hyperparameter setup using command-line arguments</li><li>Loading MNIST dataset using <code>torchvision.Datasets</code> and storing it in a Dataloader.</li><li>Creating model from <code>model/model.py</code> and using <code>Adadelta</code> optimizer and NLL Loss.</li><li>Training Loop in <code>train</code> function.</li><li>Unit Testing using <code>torchblaze.mltests</code> which is clearly detailed <a href="https://mlh-fellowship.github.io/torchblaze/docs/mltests" target="_blank" rel="noopener noreferrer">here</a></li><li>Testing Loop in <code>test</code> function.</li><li>Epoch Loop, model evaluation and model saving in <code>main</code> function.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-apppy"></a># app.py<a class="hash-link" href="#-apppy" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="file-purpose-2"></a>File Purpose<a class="hash-link" href="#file-purpose-2" title="Direct link to heading">#</a></h4><p>This file should contain the functionality for:</p><ol><li>creating flask-restful API from flask App.</li><li>listen for POST or GET request made by a client.</li><li>parse input from request to prepare as input to the model.</li><li>parse the model output to return the model inference in a user-friendly manner.</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="file-contents-2"></a>File Contents:<a class="hash-link" href="#file-contents-2" title="Direct link to heading">#</a></h4><ol><li>Flask and Flask-RESTful packages are used to create the REST API.</li><li>A <code>Resource</code> is created which listens to POST requests for image files.</li><li>The Resource is added to the API along with two other dummy resources for running <a href="https://mlh-fellowship.github.io/torchblaze/docs/apitest" target="_blank" rel="noopener noreferrer">API tests</a></li><li>Input image file is resized and converted to a <code>torch.Tensor</code>, prepared for inference.</li><li>The argmax of model output gives the predicted class which is returned as a JSON to the client. </li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-modelutilspy"></a># model/utils.py<a class="hash-link" href="#-modelutilspy" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="file-purpose-3"></a>File Purpose<a class="hash-link" href="#file-purpose-3" title="Direct link to heading">#</a></h4><p>This file should contain the functionality for any additional helper functions that are required for the other sections of the model code but do not fit into the core ML workflow as defined in the purpose of <code>model/train.py</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-procfile"></a># Procfile<a class="hash-link" href="#-procfile" title="Direct link to heading">#</a></h3><p>Heroku Apps require a Procfile which specifies the commands that would run on the start of a Heroku App. A more detailed explanation regarding Procfiles can be found <a href="https://devcenter.heroku.com/articles/procfile" target="_blank" rel="noopener noreferrer">here</a>. The template provides a Procfile that you can directly use to deploy your API.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-docker"></a># Docker<a class="hash-link" href="#-docker" title="Direct link to heading">#</a></h3><p>This file is used to create the docker image for the API to make it runnable on any system. The Docker image generation has been described in detail <a href="https://mlh-fellowship.github.io/torchblaze/docs/docker" target="_blank" rel="noopener noreferrer">here</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="-testsjson"></a># tests.json<a class="hash-link" href="#-testsjson" title="Direct link to heading">#</a></h3><p>This file is used to create the dummy requests which are used by APITests to ensure the working of the API. The format and usage of the <code>tests.json</code> file has been described in detail <a href="https://mlh-fellowship.github.io/torchblaze/docs/apitest" target="_blank" rel="noopener noreferrer">here</a></p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/torchblaze/docs/installation"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Installation</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/torchblaze/docs/mltests"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">MLTests Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-started-with-the-template" class="table-of-contents__link">Getting Started with the template</a></li><li><a href="#running-the-template" class="table-of-contents__link">Running the template</a></li><li><a href="#contents-of-the-template" class="table-of-contents__link">Contents of the Template</a><ul><li><a href="#-modelmodelpy" class="table-of-contents__link"># model/model.py</a></li><li><a href="#-modeltrainpy" class="table-of-contents__link"># model/train.py</a></li><li><a href="#-apppy" class="table-of-contents__link"># app.py</a></li><li><a href="#-modelutilspy" class="table-of-contents__link"># model/utils.py</a></li><li><a href="#-procfile" class="table-of-contents__link"># Procfile</a></li><li><a href="#-docker" class="table-of-contents__link"># Docker</a></li><li><a href="#-testsjson" class="table-of-contents__link"># tests.json</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/torchblaze/docs/installation/">Installation</a></li><li class="footer__item"><a class="footer__link-item" href="/torchblaze/docs/setup/">Quick Setup</a></li><li class="footer__item"><a class="footer__link-item" href="/torchblaze/docs/mltests/">Model Testing</a></li><li class="footer__item"><a class="footer__link-item" href="/torchblaze/docs/apitest/">API Testing</a></li><li class="footer__item"><a class="footer__link-item" href="/torchblaze/docs/docker/">Quick Dockerizing</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/torchblaze/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/MLH-Fellowship/torchblaze" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 TorchBlaze, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/torchblaze/styles.59e02f7c.js"></script>
<script src="/torchblaze/runtime~main.1033aead.js"></script>
<script src="/torchblaze/main.b0f00e50.js"></script>
<script src="/torchblaze/common.97de925f.js"></script>
<script src="/torchblaze/2.8c9f76bf.js"></script>
<script src="/torchblaze/28.94914dfa.js"></script>
<script src="/torchblaze/29.a3a5c550.js"></script>
<script src="/torchblaze/935f2afb.aede11c5.js"></script>
<script src="/torchblaze/17896441.c19fbad7.js"></script>
<script src="/torchblaze/3847b3ea.94b8f644.js"></script>
</body>
</html>